### Test PromptBuilder & AI Analysis Endpoints
### Các endpoint sử dụng PromptBuilder để phân tích kiến trúc hệ thống

@baseUrl = http://localhost:5000
@apiUrl = {{baseUrl}}/api/ai

### 1. Phân tích kiến trúc tổng thể
POST {{apiUrl}}/analyze-architecture
Content-Type: application/json

{
  "nodes": [
    {
      "id": "node_1",
      "type": "customNode",
      "metadata": {
        "label": "API Gateway",
        "category": "TrafficManager",
        "specs": {
          "latencyBase": 10,
          "maxThroughput": 5000,
          "reliability": 0.999
        },
        "technologies": ["NGINX", "Kong"],
        "provider": "AWS",
        "props": {
          "instanceCount": 3,
          "isClustered": true,
          "region": "us-east-1"
        },
        "simulation": {
          "processingTimeMs": 5,
          "failureRate": 0.001,
          "queueSize": 100
        },
        "logic": {
          "canReceiveFrom": ["client", "loadBalancer"],
          "canSendTo": ["microservice", "database"]
        }
      },
      "position": {
        "x": 100,
        "y": 100
      }
    },
    {
      "id": "node_2",
      "type": "customNode",
      "metadata": {
        "label": "User Service",
        "category": "Compute",
        "specs": {
          "latencyBase": 50,
          "maxThroughput": 1000,
          "reliability": 0.995
        },
        "technologies": ["Node.js", "Express"],
        "provider": "AWS",
        "props": {
          "instanceCount": 5,
          "isClustered": true,
          "region": "us-east-1"
        },
        "simulation": {
          "processingTimeMs": 20,
          "failureRate": 0.005
        }
      },
      "position": {
        "x": 300,
        "y": 100
      }
    },
    {
      "id": "node_3",
      "type": "customNode",
      "metadata": {
        "label": "PostgreSQL",
        "category": "Storage",
        "specs": {
          "latencyBase": 5,
          "maxThroughput": 10000,
          "reliability": 0.9999
        },
        "technologies": ["PostgreSQL"],
        "provider": "AWS RDS",
        "props": {
          "instanceCount": 1,
          "isClustered": false,
          "backupPolicy": "Daily",
          "region": "us-east-1"
        }
      },
      "position": {
        "x": 500,
        "y": 100
      }
    },
    {
      "id": "node_4",
      "type": "customNode",
      "metadata": {
        "label": "Redis Cache",
        "category": "Middleware",
        "specs": {
          "latencyBase": 1,
          "maxThroughput": 100000,
          "reliability": 0.9999
        },
        "technologies": ["Redis"],
        "provider": "AWS ElastiCache",
        "props": {
          "instanceCount": 2,
          "isClustered": true,
          "region": "us-east-1"
        }
      },
      "position": {
        "x": 300,
        "y": 300
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "node_1",
      "target": "node_2",
      "label": "HTTP Request",
      "data": {
        "protocol": "HTTPS",
        "auth": "JWT",
        "trafficWeight": 1.0,
        "networkLatency": 5
      }
    },
    {
      "id": "edge_2",
      "source": "node_2",
      "target": "node_3",
      "label": "Database Query",
      "data": {
        "protocol": "TCP",
        "auth": "Password",
        "trafficWeight": 0.8,
        "networkLatency": 2
      }
    },
    {
      "id": "edge_3",
      "source": "node_2",
      "target": "node_4",
      "label": "Cache Lookup",
      "data": {
        "protocol": "Redis Protocol",
        "auth": "Password",
        "trafficWeight": 0.9,
        "networkLatency": 1
      }
    }
  ]
}

###

### 2. Đề xuất cải thiện Performance
POST {{apiUrl}}/suggest-performance
Content-Type: application/json

{
  "nodes": [
    {
      "id": "node_1",
      "type": "customNode",
      "metadata": {
        "label": "API Gateway",
        "category": "TrafficManager",
        "specs": {
          "latencyBase": 10,
          "maxThroughput": 5000,
          "reliability": 0.999
        },
        "technologies": ["NGINX"],
        "provider": "AWS"
      }
    },
    {
      "id": "node_2",
      "type": "customNode",
      "metadata": {
        "label": "Monolithic API",
        "category": "Compute",
        "specs": {
          "latencyBase": 200,
          "maxThroughput": 500,
          "reliability": 0.95
        },
        "technologies": ["Java", "Spring Boot"],
        "provider": "AWS",
        "simulation": {
          "processingTimeMs": 150,
          "failureRate": 0.05
        }
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "node_1",
      "target": "node_2",
      "data": {
        "protocol": "HTTP",
        "trafficWeight": 1.0,
        "networkLatency": 10
      }
    }
  ]
}

###

### 3. Phát hiện vấn đề bảo mật
POST {{apiUrl}}/detect-security-issues
Content-Type: application/json

{
  "nodes": [
    {
      "id": "node_1",
      "type": "customNode",
      "metadata": {
        "label": "Public API",
        "category": "EntryPoint",
        "specs": {
          "latencyBase": 10,
          "maxThroughput": 10000,
          "reliability": 0.99
        },
        "technologies": ["Express.js"]
      }
    },
    {
      "id": "node_2",
      "type": "customNode",
      "metadata": {
        "label": "User Database",
        "category": "Storage",
        "specs": {
          "latencyBase": 5,
          "maxThroughput": 5000,
          "reliability": 0.999
        },
        "technologies": ["MongoDB"]
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "node_1",
      "target": "node_2",
      "data": {
        "protocol": "MongoDB Protocol",
        "networkLatency": 2
      }
    }
  ]
}

###

### 4. Tạo tài liệu kiến trúc
POST {{apiUrl}}/generate-documentation
Content-Type: application/json

{
  "projectName": "E-Commerce Platform",
  "diagramData": {
    "nodes": [
      {
        "id": "node_1",
        "type": "customNode",
        "metadata": {
          "label": "API Gateway",
          "category": "TrafficManager",
          "specs": {
            "latencyBase": 10,
            "maxThroughput": 5000,
            "reliability": 0.999
          },
          "technologies": ["NGINX", "Kong"],
          "provider": "AWS"
        }
      },
      {
        "id": "node_2",
        "type": "customNode",
        "metadata": {
          "label": "Product Service",
          "category": "Compute",
          "specs": {
            "latencyBase": 50,
            "maxThroughput": 1000,
            "reliability": 0.995
          },
          "technologies": [".NET", "C#"],
          "provider": "AWS"
        }
      },
      {
        "id": "node_3",
        "type": "customNode",
        "metadata": {
          "label": "Order Service",
          "category": "Compute",
          "specs": {
            "latencyBase": 50,
            "maxThroughput": 1000,
            "reliability": 0.995
          },
          "technologies": [".NET", "C#"],
          "provider": "AWS"
        }
      }
    ],
    "edges": [
      {
        "id": "edge_1",
        "source": "node_1",
        "target": "node_2",
        "data": {
          "protocol": "HTTPS",
          "auth": "JWT"
        }
      },
      {
        "id": "edge_2",
        "source": "node_1",
        "target": "node_3",
        "data": {
          "protocol": "HTTPS",
          "auth": "JWT"
        }
      }
    ]
  }
}

###

### 5. So sánh với Design Patterns
POST {{apiUrl}}/compare-patterns
Content-Type: application/json

{
  "nodes": [
    {
      "id": "node_1",
      "type": "customNode",
      "metadata": {
        "label": "Event Bus",
        "category": "Middleware",
        "specs": {
          "latencyBase": 5,
          "maxThroughput": 50000,
          "reliability": 0.9999
        },
        "technologies": ["RabbitMQ"]
      }
    },
    {
      "id": "node_2",
      "type": "customNode",
      "metadata": {
        "label": "Order Service",
        "category": "Compute",
        "specs": {
          "latencyBase": 50,
          "maxThroughput": 1000,
          "reliability": 0.99
        }
      }
    },
    {
      "id": "node_3",
      "type": "customNode",
      "metadata": {
        "label": "Inventory Service",
        "category": "Compute",
        "specs": {
          "latencyBase": 50,
          "maxThroughput": 1000,
          "reliability": 0.99
        }
      }
    },
    {
      "id": "node_4",
      "type": "customNode",
      "metadata": {
        "label": "Payment Service",
        "category": "Compute",
        "specs": {
          "latencyBase": 100,
          "maxThroughput": 500,
          "reliability": 0.999
        }
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "node_2",
      "target": "node_1",
      "data": {
        "protocol": "AMQP"
      }
    },
    {
      "id": "edge_2",
      "source": "node_1",
      "target": "node_3",
      "data": {
        "protocol": "AMQP"
      }
    },
    {
      "id": "edge_3",
      "source": "node_1",
      "target": "node_4",
      "data": {
        "protocol": "AMQP"
      }
    }
  ]
}

###

### 6. Ước tính chi phí vận hành
POST {{apiUrl}}/estimate-cost
Content-Type: application/json

{
  "expectedTrafficPerDay": 10000000,
  "diagramData": {
    "nodes": [
      {
        "id": "node_1",
        "type": "customNode",
        "metadata": {
          "label": "API Gateway",
          "category": "TrafficManager",
          "specs": {
            "latencyBase": 10,
            "maxThroughput": 5000,
            "reliability": 0.999
          },
          "technologies": ["AWS API Gateway"],
          "provider": "AWS",
          "props": {
            "instanceCount": 3,
            "region": "us-east-1"
          }
        }
      },
      {
        "id": "node_2",
        "type": "customNode",
        "metadata": {
          "label": "Application Servers",
          "category": "Compute",
          "specs": {
            "latencyBase": 50,
            "maxThroughput": 1000,
            "reliability": 0.995
          },
          "technologies": ["EC2"],
          "provider": "AWS",
          "props": {
            "instanceCount": 10,
            "region": "us-east-1"
          }
        }
      },
      {
        "id": "node_3",
        "type": "customNode",
        "metadata": {
          "label": "RDS PostgreSQL",
          "category": "Storage",
          "specs": {
            "latencyBase": 5,
            "maxThroughput": 10000,
            "reliability": 0.9999
          },
          "technologies": ["PostgreSQL"],
          "provider": "AWS RDS",
          "props": {
            "instanceCount": 1,
            "backupPolicy": "Daily"
          }
        }
      },
      {
        "id": "node_4",
        "type": "customNode",
        "metadata": {
          "label": "Redis Cache",
          "category": "Middleware",
          "specs": {
            "latencyBase": 1,
            "maxThroughput": 100000,
            "reliability": 0.9999
          },
          "technologies": ["Redis"],
          "provider": "AWS ElastiCache",
          "props": {
            "instanceCount": 2
          }
        }
      },
      {
        "id": "node_5",
        "type": "customNode",
        "metadata": {
          "label": "S3 Storage",
          "category": "Storage",
          "specs": {
            "latencyBase": 10,
            "maxThroughput": 50000,
            "reliability": 0.99999
          },
          "technologies": ["S3"],
          "provider": "AWS"
        }
      }
    ],
    "edges": [
      {
        "id": "edge_1",
        "source": "node_1",
        "target": "node_2",
        "data": {
          "protocol": "HTTPS"
        }
      },
      {
        "id": "edge_2",
        "source": "node_2",
        "target": "node_3",
        "data": {
          "protocol": "TCP"
        }
      },
      {
        "id": "edge_3",
        "source": "node_2",
        "target": "node_4",
        "data": {
          "protocol": "Redis Protocol"
        }
      },
      {
        "id": "edge_4",
        "source": "node_2",
        "target": "node_5",
        "data": {
          "protocol": "HTTPS"
        }
      }
    ]
  }
}

###
